對等通信協議

# 協議頭``<kp>``

# L1 請求行

- p0 版本號：0.1開始
- p1 消息類型：
  - 主動式：
    - GET：由服務器主動向客戶端申請設備資源訪問，需要指明客戶端設備信息、時間戳範圍（後追加設備字段）
    - SND：由客戶端主動向服務器提交設備數據，需要指明客戶端設備信息、時間戳（後追加設備字段、數據字段）
  - 信息反饋式：
    - ACK：確認請求
    - RFS：拒絕請求（後追加數據字段）

# L2 設備字段
- p0 設備屬：01：藍牙、02：GPS等
- p1 設備號：設備的UUID
- p2 發送時候的時間戳
- p3 時間戳偏移（僅限GET字段）

# L3 指令擴展字段
- p0 此塊區為以後的擴展協議保留擴展空間，以{}大括號為起始結束點。

# L4數據字段
（數據字段建議使用json），頭尾使用<>標籤分割

# 結束符</kp>

# sample1
服務器從客戶端藍牙獲取信息（2017-11-19 12:36:32 的過去30秒內）：
```
<kp>
0.1 GET
01 0f2678e3-d77d-4dd9-bea5-021826903b01 1511066192 30
{}
</kp>
```

客戶端反饋：
```
<kp>
0.1 SND
01 0f2678e3-d77d-4dd9-bea5-021826903b01 1511066195
{}
<>1511066175 this is the data range1
1511066181 this is the data range2
1511066183 this is the data range3</>
</kp>
```

服務器接收到最後的</>，表示信息全部收到，反饋ACK
```
<kp>
0.1 ACK
{}
</kp>
```

客戶端拒絕：
```
<kp>
0.1 RFS
{}
exception occurred
</kp>
```

客戶端反饋超時：
在服務器端設置超時丟棄和重傳機制，依靠上面GET和ACK之間的時間戳差值作為標準（即GET發出的時間和ACK發出的時間差）

# sample2
客戶端主動向服務器發GPS信息：
```
<kp>
0.1 SND
02 351e6515-6543-4fa3-9025-85f6f836b2cf 1511066195
{}
<>1511066175 this is the data range1
1511066181 this is the data range2
1511066183 this is the data range3</>
</kp>
```

服務器收到信息進行反饋
```
<kp>
0.1 ACK
{}
</kp>
```
